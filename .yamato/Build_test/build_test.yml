# Refer to virtualproduction Mono repo for details about the setup for how to add build tests
packages : 
  - short_name : "Cluster_Diplay_URP"
    project_path : TestProjects/GraphicsTestsURP  
    name : "ClusterDisplay"
    package_path : source/com.unity.cluster-display
    
  - short_name : "Cluster_Diplay_HDRP"
    project_path : TestProjects/GraphicsTestsHDRP 
    name : "ClusterDisplay"
    package_path : source/com.unity.cluster-display
   
 
default_editor : 2023.1

---

{% for package in packages %}

Build_test_{{package.short_name}} : 
  name : Build_test_{{package.short_name}}
  agent: 
    type : Unity::VM
    image : package-ci/win10:v4
    flavor : b1.large
  commands: 
    - choco install unity-downloader-cli -y 
    - unity-downloader-cli -u {{default_editor}} -c editor --wait --published
    - choco install standaloneutr -s https://artifactory.prd.it.unity3d.com/artifactory/api/nuget/unity-choco-local -y
    - choco install unity-config -y
    #Moving the tests from the .yamato to the project to test in
    - move .yamato/Build_test/BuildTests {{package.project_path}}/Assets
    - UnifiedTestRunner.exe --suite=editor --testproject={% if package.project_path == nil %}{{package.name}}_buildingTest{%endif%}{{package.project_path}} --editor-location=.Editor --artifacts_path=test-results  --testFilter=Build_test.BuildTest
  artifacts:
    logs:
      paths:
        - "test-results/**/*"
{%endfor%}  



